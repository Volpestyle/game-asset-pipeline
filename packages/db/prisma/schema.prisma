generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}


model Job {
  id             String     @id
  pipelineId     String
  characterName  String
  prompt         String
  negativePrompt String?
  seed           Int?
  styleStrength  Float
  status         String     // JobStatus
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt

  stages         JobStage[]
  artifacts      Artifact[]
}

model JobStage {
  id        String      @id
  jobId     String
  stageId   String
  type      String
  status    String      // StageStatus
  startedAt DateTime?
  endedAt   DateTime?
  message   String?

  job       Job @relation(fields: [jobId], references: [id], onDelete: Cascade)

  @@unique([jobId, stageId])
}

model Artifact {
  id        String       @id
  jobId     String
  type      String       // ArtifactType
  name      String
  absPath   String
  url       String
  createdAt DateTime     @default(now())

  job       Job @relation(fields: [jobId], references: [id], onDelete: Cascade)
}

